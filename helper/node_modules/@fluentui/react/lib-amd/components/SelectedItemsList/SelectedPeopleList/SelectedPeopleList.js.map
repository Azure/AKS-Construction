{"version":3,"file":"SelectedPeopleList.js","sourceRoot":"../src/","sources":["components/SelectedItemsList/SelectedPeopleList/SelectedPeopleList.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { BaseSelectedItemsList } from '../BaseSelectedItemsList';\nimport { ExtendedSelectedItem } from './Items/ExtendedSelectedItem';\nimport { SelectedItemWithContextMenu } from './Items/SelectedItemWithContextMenu';\nimport { EditingItem } from './Items/EditingItem';\nimport type { IBaseSelectedItemsListProps, ISelectedItemProps } from '../BaseSelectedItemsList.types';\nimport type { IPersonaProps } from '../../../Persona';\nimport type { IRenderFunction } from '../../../Utilities';\nimport type { IContextualMenuItem } from '../../../ContextualMenu';\nimport type { IBaseFloatingPickerProps } from '../../../FloatingPicker';\n\n/**\n * {@docCategory SelectedPeopleList}\n */\nexport interface IExtendedPersonaProps extends IPersonaProps {\n  key?: React.Key;\n  isValid: boolean;\n  blockRecipientRemoval?: boolean;\n  shouldBlockSelection?: boolean;\n  canExpand?: boolean;\n  isEditing?: boolean;\n}\n\n/**\n * {@docCategory SelectedPeopleList}\n */\nexport interface ISelectedPeopleItemProps extends ISelectedItemProps<IExtendedPersonaProps> {\n  onExpandItem?: () => void;\n  renderPersonaCoin?: IRenderFunction<IPersonaProps>;\n  renderPrimaryText?: IRenderFunction<IPersonaProps>;\n}\n\n/**\n * {@docCategory SelectedPeopleList}\n */\nexport interface ISelectedPeopleProps extends IBaseSelectedItemsListProps<IExtendedPersonaProps> {\n  onExpandGroup?: (item: IExtendedPersonaProps) => void;\n  removeMenuItemText?: string;\n  copyMenuItemText?: string;\n  editMenuItemText?: string;\n  getEditingItemText?: (item: IExtendedPersonaProps) => string;\n  onRenderFloatingPicker?: React.ComponentType<IBaseFloatingPickerProps<IPersonaProps>>;\n  floatingPickerProps?: IBaseFloatingPickerProps<IPersonaProps>;\n}\n\n/**\n * {@docCategory SelectedPeopleList}\n */\nexport class BasePeopleSelectedItemsList extends BaseSelectedItemsList<IExtendedPersonaProps, ISelectedPeopleProps> {}\n\n/**\n * Standard People Picker.\n */\nexport class SelectedPeopleList extends BasePeopleSelectedItemsList {\n  public static defaultProps: any = {\n    onRenderItem: (props: ISelectedPeopleItemProps) => <ExtendedSelectedItem {...props} />,\n  };\n\n  protected renderItems = (): JSX.Element[] => {\n    const { items } = this.state;\n    return items.map((item: IExtendedPersonaProps, index: number) => this._renderItem(item, index));\n  };\n\n  private _renderItem(item: IExtendedPersonaProps, index: number): JSX.Element {\n    const { removeButtonAriaLabel } = this.props;\n    const expandGroup = this.props.onExpandGroup;\n    const props = {\n      item,\n      index,\n      key: item.key ? item.key : index,\n      selected: this.selection.isIndexSelected(index),\n      onRemoveItem: () => this.removeItem(item),\n      onItemChange: this.onItemChange,\n      removeButtonAriaLabel: removeButtonAriaLabel,\n      onCopyItem: (itemToCopy: IExtendedPersonaProps) => this.copyItems([itemToCopy]),\n      onExpandItem: expandGroup ? () => expandGroup(item) : undefined,\n      menuItems: this._createMenuItems(item),\n    };\n\n    const hasContextMenu = props.menuItems.length > 0;\n    if ((item as IExtendedPersonaProps).isEditing && hasContextMenu) {\n      return (\n        <EditingItem\n          {...props}\n          onRenderFloatingPicker={this.props.onRenderFloatingPicker}\n          floatingPickerProps={this.props.floatingPickerProps}\n          onEditingComplete={this._completeEditing}\n          getEditingItemText={this.props.getEditingItemText}\n        />\n      );\n    } else {\n      // This cast is here because we are guaranteed that onRenderItem is set\n      // from static defaultProps\n      // TODO: Move this component to composition with required onRenderItem to remove\n      // this cast.\n      const onRenderItem = this.props.onRenderItem as (props: ISelectedPeopleItemProps) => JSX.Element;\n      const renderedItem = onRenderItem(props);\n      return hasContextMenu ? (\n        <SelectedItemWithContextMenu\n          key={props.key}\n          renderedItem={renderedItem}\n          beginEditing={this._beginEditing}\n          menuItems={this._createMenuItems(props.item)}\n          item={props.item}\n        />\n      ) : (\n        renderedItem\n      );\n    }\n  }\n\n  private _beginEditing = (item: IExtendedPersonaProps): void => {\n    item.isEditing = true;\n    this.forceUpdate();\n  };\n\n  private _completeEditing = (oldItem: any, newItem: any): void => {\n    oldItem.isEditing = false;\n    this.replaceItem(oldItem, newItem);\n  };\n\n  private _createMenuItems(item: any): IContextualMenuItem[] {\n    const menuItems: IContextualMenuItem[] = [];\n\n    if (this.props.editMenuItemText && this.props.getEditingItemText) {\n      menuItems.push({\n        key: 'Edit',\n        text: this.props.editMenuItemText,\n        onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\n          this._beginEditing(menuItem.data);\n        },\n        data: item,\n      });\n    }\n\n    if (this.props.removeMenuItemText) {\n      menuItems.push({\n        key: 'Remove',\n        text: this.props.removeMenuItemText,\n        onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\n          this.removeItem(menuItem.data as IExtendedPersonaProps);\n        },\n        data: item,\n      });\n    }\n\n    if (this.props.copyMenuItemText) {\n      menuItems.push({\n        key: 'Copy',\n        text: this.props.copyMenuItemText,\n        onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\n          if (this.props.onCopyItems) {\n            (this.copyItems as (items: IExtendedPersonaProps[]) => void)([menuItem.data] as IExtendedPersonaProps[]);\n          }\n        },\n        data: item,\n      });\n    }\n\n    return menuItems;\n  }\n}\n"]}