{"version":3,"file":"PersonaPresence.base.js","sourceRoot":"../src/","sources":["components/Persona/PersonaPresence/PersonaPresence.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { classNamesFunction } from '../../../Utilities';\nimport { Icon } from '../../../Icon';\nimport { PersonaPresence as PersonaPresenceEnum, PersonaSize } from '../Persona.types';\nimport { sizeBoolean } from '../PersonaConsts';\nimport { useMergedRefs } from '@fluentui/react-hooks';\nimport type { IPersonaPresenceProps, IPersonaPresenceStyleProps, IPersonaPresenceStyles } from '../Persona.types';\n\nconst coinSizeFontScaleFactor = 6;\nconst coinSizePresenceScaleFactor = 3;\nconst presenceMaxSize = 40;\nconst presenceFontMaxSize = 20;\n\nconst getClassNames = classNamesFunction<IPersonaPresenceStyleProps, IPersonaPresenceStyles>({\n  // There can be many PersonaPresence rendered with different sizes.\n  // Therefore setting a larger cache size.\n  cacheSize: 100,\n});\n\n/**\n * PersonaPresence with no default styles.\n * [Use the `getStyles` API to add your own styles.](https://github.com/microsoft/fluentui/wiki/Styling)\n */\nexport const PersonaPresenceBase: React.FunctionComponent<IPersonaPresenceProps> = React.forwardRef<\n  HTMLDivElement,\n  IPersonaPresenceProps\n>((props, forwardedRef) => {\n  const {\n    coinSize,\n    isOutOfOffice,\n    styles, // Use getStyles from props.\n    presence,\n    theme,\n    presenceTitle,\n    presenceColors,\n  } = props;\n\n  const rootRef = React.useRef<HTMLDivElement>(null);\n  const mergedRootRef = useMergedRefs(forwardedRef, rootRef);\n\n  const size = sizeBoolean(props.size as PersonaSize);\n\n  // Render Presence Icon if Persona is above size 32.\n  const renderIcon =\n    !(size.isSize8 || size.isSize10 || size.isSize16 || size.isSize24 || size.isSize28 || size.isSize32) &&\n    (coinSize ? coinSize > 32 : true);\n\n  const presenceHeightWidth: string = coinSize\n    ? coinSize / coinSizePresenceScaleFactor < presenceMaxSize\n      ? coinSize / coinSizePresenceScaleFactor + 'px'\n      : presenceMaxSize + 'px'\n    : '';\n  const presenceFontSize: string = coinSize\n    ? coinSize / coinSizeFontScaleFactor < presenceFontMaxSize\n      ? coinSize / coinSizeFontScaleFactor + 'px'\n      : presenceFontMaxSize + 'px'\n    : '';\n  const coinSizeWithPresenceIconStyle = coinSize\n    ? { fontSize: presenceFontSize, lineHeight: presenceHeightWidth }\n    : undefined;\n  const coinSizeWithPresenceStyle = coinSize ? { width: presenceHeightWidth, height: presenceHeightWidth } : undefined;\n\n  // Use getStyles from props, or fall back to getStyles from styles file.\n  const classNames = getClassNames(styles, {\n    theme: theme!,\n    presence,\n    size: props.size,\n    isOutOfOffice,\n    presenceColors,\n  });\n\n  if (presence === PersonaPresenceEnum.none) {\n    return null;\n  }\n\n  return (\n    <div\n      role=\"presentation\"\n      className={classNames.presence}\n      style={coinSizeWithPresenceStyle}\n      title={presenceTitle}\n      ref={mergedRootRef}\n    >\n      {renderIcon && (\n        <Icon\n          className={classNames.presenceIcon}\n          iconName={determineIcon(props.presence, props.isOutOfOffice)}\n          style={coinSizeWithPresenceIconStyle}\n        />\n      )}\n    </div>\n  );\n});\nPersonaPresenceBase.displayName = 'PersonaPresenceBase';\n\nfunction determineIcon(\n  presence: PersonaPresenceEnum | undefined,\n  isOutOfOffice: boolean | undefined,\n): string | undefined {\n  if (!presence) {\n    return undefined;\n  }\n\n  const oofIcon = 'SkypeArrow';\n\n  switch (PersonaPresenceEnum[presence]) {\n    case 'online':\n      return 'SkypeCheck';\n    case 'away':\n      return isOutOfOffice ? oofIcon : 'SkypeClock';\n    case 'dnd':\n      return 'SkypeMinus';\n    case 'offline':\n      return isOutOfOffice ? oofIcon : '';\n  }\n\n  return '';\n}\n"]}