{"version":3,"file":"useKeytipRef.js","sourceRoot":"../src/","sources":["components/KeytipData/useKeytipRef.ts"],"names":[],"mappings":";;;;IAKA;;;OAGG;IACH,SAAgB,YAAY,CAC1B,OAA0B;QAEpB,IAAA,KAAgC,6BAAa,CAAC,OAAO,CAAC,EAApD,QAAQ,cAAA,EAAE,eAAe,qBAA2B,CAAC;QAE7D,IAAM,UAAU,GAAwB,KAAK,CAAC,WAAW,CACvD,UAAC,cAA+B;YAC9B,IAAI,CAAC,cAAc,EAAE;gBACnB,OAAO;aACR;YAED,IAAM,aAAa,GAAG,gBAAgB,CAAC,cAAc,EAAE,sBAAc,CAAC,IAAI,cAAc,CAAC;YACzF,IAAM,cAAc,GAAG,gBAAgB,CAAC,cAAc,EAAE,8BAAsB,CAAC,IAAI,aAAa,CAAC;YACjG,IAAM,WAAW,GAAG,gBAAgB,CAAC,cAAc,EAAE,2BAAmB,CAAC,IAAI,cAAc,CAAC;YAE5F,YAAY,CAAC,aAAa,EAAE,sBAAc,EAAE,QAAQ,CAAC,CAAC;YACtD,YAAY,CAAC,cAAc,EAAE,8BAAsB,EAAE,QAAQ,CAAC,CAAC;YAC/D,YAAY,CAAC,WAAW,EAAE,kBAAkB,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;QACvE,CAAC,EACD,CAAC,QAAQ,EAAE,eAAe,CAAC,CAC5B,CAAC;QAEF,OAAO,UAAU,CAAC;IACpB,CAAC;IAvBD,oCAuBC;IAED,SAAgB,YAAY,CAC1B,OAA2B,EAC3B,aAAqB,EACrB,cAAkC,EAClC,MAAuB;QAAvB,uBAAA,EAAA,cAAuB;QAEvB,IAAI,OAAO,IAAI,cAAc,EAAE;YAC7B,IAAI,KAAK,GAAG,cAAc,CAAC;YAC3B,IAAI,MAAM,EAAE;gBACV,IAAM,YAAY,GAAG,OAAO,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;gBACzD,IAAI,YAAY,IAAI,YAAY,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,EAAE;oBAC/D,KAAK,GAAM,YAAY,SAAI,cAAgB,CAAC;iBAC7C;aACF;YAED,OAAO,CAAC,YAAY,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;SAC5C;IACH,CAAC;IAjBD,oCAiBC;IAED,SAAS,gBAAgB,CAAC,WAAwB,EAAE,aAAqB;QACvE,OAAO,WAAW,CAAC,aAAa,CAAC,MAAI,aAAa,MAAG,CAAC,CAAC;IACzD,CAAC","sourcesContent":["import * as React from 'react';\nimport { DATAKTP_TARGET, DATAKTP_EXECUTE_TARGET, DATAKTP_ARIA_TARGET } from '../../utilities/keytips/index';\nimport { useKeytipData } from './useKeytipData';\nimport type { KeytipDataOptions } from './KeytipData.types';\n\n/**\n * Hook that creates a ref which is used for passing to Keytip target element.\n * The ref will handle setting the attributes needed for Keytip to work.\n */\nexport function useKeytipRef<TElement extends HTMLElement = HTMLElement>(\n  options: KeytipDataOptions,\n): React.Ref<TElement> {\n  const { keytipId, ariaDescribedBy } = useKeytipData(options);\n\n  const contentRef: React.Ref<TElement> = React.useCallback(\n    (contentElement: TElement | null): void => {\n      if (!contentElement) {\n        return;\n      }\n\n      const targetElement = findFirstElement(contentElement, DATAKTP_TARGET) || contentElement;\n      const executeElement = findFirstElement(contentElement, DATAKTP_EXECUTE_TARGET) || targetElement;\n      const ariaElement = findFirstElement(contentElement, DATAKTP_ARIA_TARGET) || executeElement;\n\n      setAttribute(targetElement, DATAKTP_TARGET, keytipId);\n      setAttribute(executeElement, DATAKTP_EXECUTE_TARGET, keytipId);\n      setAttribute(ariaElement, 'aria-describedby', ariaDescribedBy, true);\n    },\n    [keytipId, ariaDescribedBy],\n  );\n\n  return contentRef;\n}\n\nexport function setAttribute(\n  element: HTMLElement | null,\n  attributeName: string,\n  attributeValue: string | undefined,\n  append: boolean = false,\n): void {\n  if (element && attributeValue) {\n    let value = attributeValue;\n    if (append) {\n      const currentValue = element.getAttribute(attributeName);\n      if (currentValue && currentValue.indexOf(attributeValue) === -1) {\n        value = `${currentValue} ${attributeValue}`;\n      }\n    }\n\n    element.setAttribute(attributeName, value);\n  }\n}\n\nfunction findFirstElement(rootElement: HTMLElement, dataAttribute: string): HTMLElement | null {\n  return rootElement.querySelector(`[${dataAttribute}]`);\n}\n"]}