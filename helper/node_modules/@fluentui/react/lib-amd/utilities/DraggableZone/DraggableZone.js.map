{"version":3,"file":"DraggableZone.js","sourceRoot":"../src/","sources":["utilities/DraggableZone/DraggableZone.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { getClassNames } from './DraggableZone.styles';\nimport { on } from '../../Utilities';\nimport type { IDraggableZoneProps, ICoordinates, IDragData } from './DraggableZone.types';\n\nexport interface IDraggableZoneState {\n  isDragging: boolean;\n  position: ICoordinates;\n  lastPosition?: ICoordinates;\n}\n\nconst eventMapping = {\n  touch: {\n    start: 'touchstart',\n    move: 'touchmove',\n    stop: 'touchend',\n  },\n  mouse: {\n    start: 'mousedown',\n    move: 'mousemove',\n    stop: 'mouseup',\n  },\n};\n\n// These are needed so that we can generalize the events\n// and so we have access to clientX and clientY in the touch events\ntype MouseTouchEvent<T> = React.MouseEvent<T> & React.TouchEvent<T> & Event;\n\nexport class DraggableZone extends React.Component<IDraggableZoneProps, IDraggableZoneState> {\n  private _touchId?: number;\n  private _currentEventType = eventMapping.mouse;\n  private _events: (() => void)[] = [];\n\n  constructor(props: IDraggableZoneProps) {\n    super(props);\n\n    this.state = {\n      isDragging: false,\n      position: this.props.position || { x: 0, y: 0 },\n      lastPosition: undefined,\n    };\n  }\n\n  public componentDidUpdate(prevProps: IDraggableZoneProps) {\n    if (this.props.position && (!prevProps.position || this.props.position !== prevProps.position)) {\n      this.setState({ position: this.props.position });\n    }\n  }\n\n  public componentWillUnmount() {\n    this._events.forEach(dispose => dispose());\n  }\n\n  public render() {\n    const child: any = React.Children.only(this.props.children);\n    const { props } = child;\n    const { position } = this.props;\n    const { position: statePosition, isDragging } = this.state;\n    let x = statePosition.x;\n    let y = statePosition.y;\n\n    if (position && !isDragging) {\n      x = position.x;\n      y = position.y;\n    }\n\n    return React.cloneElement(child, {\n      style: {\n        ...props.style,\n        transform: `translate(${x}px, ${y}px)`,\n      },\n      className: getClassNames(props.className, this.state.isDragging).root,\n      onMouseDown: this._onMouseDown,\n      onMouseUp: this._onMouseUp,\n      onTouchStart: this._onTouchStart,\n      onTouchEnd: this._onTouchEnd,\n    });\n  }\n\n  private _onMouseDown = (event: MouseTouchEvent<HTMLElement>) => {\n    const onMouseDown = (React.Children.only(this.props.children) as any).props.onMouseDown;\n    if (onMouseDown) {\n      onMouseDown(event);\n    }\n\n    this._currentEventType = eventMapping.mouse;\n    return this._onDragStart(event);\n  };\n\n  private _onMouseUp = (event: MouseTouchEvent<HTMLElement>) => {\n    const onMouseUp = (React.Children.only(this.props.children) as any).props.onMouseUp;\n    if (onMouseUp) {\n      onMouseUp(event);\n    }\n\n    this._currentEventType = eventMapping.mouse;\n    return this._onDragStop(event);\n  };\n\n  private _onTouchStart = (event: MouseTouchEvent<HTMLElement>) => {\n    const onTouchStart = (React.Children.only(this.props.children) as any).props.onTouchStart;\n    if (onTouchStart) {\n      onTouchStart(event);\n    }\n\n    this._currentEventType = eventMapping.touch;\n    return this._onDragStart(event);\n  };\n\n  private _onTouchEnd = (event: MouseTouchEvent<HTMLElement>) => {\n    const onTouchEnd = (React.Children.only(this.props.children) as any).props.onTouchEnd;\n    if (onTouchEnd) {\n      onTouchEnd(event);\n    }\n\n    this._currentEventType = eventMapping.touch;\n    this._onDragStop(event);\n  };\n\n  private _onDragStart = (event: MouseTouchEvent<HTMLElement>) => {\n    // Only handle left click for dragging\n    if (typeof event.button === 'number' && event.button !== 0) {\n      return false;\n    }\n\n    // If the target doesn't match the handleSelector OR\n    // if the target does match the preventDragSelector, bail out\n    if (\n      (this.props.handleSelector && !this._matchesSelector(event.target as HTMLElement, this.props.handleSelector)) ||\n      (this.props.preventDragSelector &&\n        this._matchesSelector(event.target as HTMLElement, this.props.preventDragSelector))\n    ) {\n      return;\n    }\n\n    // Remember the touch identifier if this is a touch event so we can\n    // distinguish between individual touches in multitouch scenarios\n    // by remembering which touch point we were given\n    this._touchId = this._getTouchId(event);\n\n    const position = this._getControlPosition(event);\n    if (position === undefined) {\n      return;\n    }\n\n    const dragData = this._createDragDataFromPosition(position);\n    this.props.onStart && this.props.onStart(event, dragData);\n\n    this.setState({\n      isDragging: true,\n      lastPosition: position,\n    });\n\n    // hook up the appropriate mouse/touch events to the body to ensure\n    // smooth dragging\n    this._events = [\n      on(document.body, this._currentEventType.move, this._onDrag, true /* use capture phase */),\n      on(document.body, this._currentEventType.stop, this._onDragStop, true /* use capture phase */),\n    ];\n  };\n\n  private _onDrag = (event: MouseTouchEvent<HTMLElement>) => {\n    // Prevent scrolling on mobile devices\n    if (event.type === 'touchmove') {\n      event.preventDefault();\n    }\n\n    const position = this._getControlPosition(event);\n    if (!position) {\n      return;\n    }\n\n    // create the updated drag data from the position data\n    const updatedData = this._createUpdatedDragData(this._createDragDataFromPosition(position));\n    const updatedPosition = updatedData.position;\n\n    this.props.onDragChange && this.props.onDragChange(event, updatedData);\n\n    this.setState({\n      position: updatedPosition,\n      lastPosition: position,\n    });\n  };\n\n  private _onDragStop = (event: MouseTouchEvent<HTMLElement>) => {\n    if (!this.state.isDragging) {\n      return;\n    }\n\n    const position = this._getControlPosition(event);\n    if (!position) {\n      return;\n    }\n\n    const baseDragData = this._createDragDataFromPosition(position);\n\n    // Set dragging to false and reset the lastPosition\n    this.setState({\n      isDragging: false,\n      lastPosition: undefined,\n    });\n\n    this.props.onStop && this.props.onStop(event, baseDragData);\n\n    if (this.props.position) {\n      this.setState({\n        position: this.props.position,\n      });\n    }\n\n    // Remove event handlers\n    this._events.forEach(dispose => dispose());\n  };\n\n  /**\n   * Get the control position based off the event that fired\n   * @param event - The event to get offsets from\n   */\n  private _getControlPosition(event: MouseTouchEvent<HTMLElement>): ICoordinates | undefined {\n    const touchObj = this._getActiveTouch(event);\n\n    // did we get the right touch?\n    if (this._touchId !== undefined && !touchObj) {\n      return undefined;\n    }\n\n    const eventToGetOffset = touchObj || event;\n    return {\n      x: eventToGetOffset.clientX,\n      y: eventToGetOffset.clientY,\n    };\n  }\n\n  /**\n   * Get the active touch point that we have saved from the event's TouchList\n   * @param event - The event used to get the TouchList for the active touch point\n   */\n  private _getActiveTouch(event: MouseTouchEvent<HTMLElement>): React.Touch | undefined {\n    return (\n      (event.targetTouches && this._findTouchInTouchList(event.targetTouches)) ||\n      (event.changedTouches && this._findTouchInTouchList(event.changedTouches))\n    );\n  }\n\n  /**\n   * Get the initial touch identifier associated with the given event\n   * @param event - The event that contains the TouchList\n   */\n  private _getTouchId(event: MouseTouchEvent<HTMLElement>): number | undefined {\n    const touch: React.Touch | undefined =\n      (event.targetTouches && event.targetTouches[0]) || (event.changedTouches && event.changedTouches[0]);\n\n    if (touch) {\n      return touch.identifier;\n    }\n  }\n\n  /**\n   * Returns if an element (or any of the element's parents) match the given selector\n   */\n  private _matchesSelector(element: HTMLElement | null, selector: string): boolean {\n    if (!element || element === document.body) {\n      return false;\n    }\n\n    const matchesSelectorFn: Function =\n      element.matches || element.webkitMatchesSelector || (element as any).msMatchesSelector; /* for IE */\n\n    if (!matchesSelectorFn) {\n      return false;\n    }\n\n    return matchesSelectorFn.call(element, selector) || this._matchesSelector(element.parentElement, selector);\n  }\n\n  /**\n   * Attempts to find the Touch that matches the identifier  we stored in dragStart\n   * @param touchList The TouchList to look for the stored identifier from dragStart\n   */\n  private _findTouchInTouchList(touchList: React.TouchList): React.Touch | undefined {\n    if (this._touchId === undefined) {\n      return;\n    }\n\n    for (let i = 0; i < touchList.length; i++) {\n      if (touchList[i].identifier === this._touchId) {\n        return touchList[i];\n      }\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Create DragData based off of the last known position and the new position passed in\n   * @param position The new position as part of the drag\n   */\n  private _createDragDataFromPosition(position: ICoordinates): IDragData {\n    const { lastPosition } = this.state;\n\n    // If we have no lastPosition, use the given position\n    // for last position\n    if (lastPosition === undefined) {\n      return {\n        delta: { x: 0, y: 0 },\n        lastPosition: position,\n        position,\n      };\n    }\n\n    return {\n      delta: {\n        x: position.x - lastPosition.x,\n        y: position.y - lastPosition.y,\n      },\n      lastPosition,\n      position,\n    };\n  }\n\n  /**\n   * Creates an updated DragData based off the current position and given baseDragData\n   * @param baseDragData The base DragData (from _createDragDataFromPosition) used to calculate the updated positions\n   */\n  private _createUpdatedDragData(baseDragData: IDragData): IDragData {\n    const { position } = this.state;\n    return {\n      position: {\n        x: position.x + baseDragData.delta.x,\n        y: position.y + baseDragData.delta.y,\n      },\n      delta: baseDragData.delta,\n      lastPosition: position,\n    };\n  }\n}\n"]}