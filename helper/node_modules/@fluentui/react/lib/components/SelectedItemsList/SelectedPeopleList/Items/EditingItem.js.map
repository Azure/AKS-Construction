{"version":3,"file":"EditingItem.js","sourceRoot":"../src/","sources":["components/SelectedItemsList/SelectedPeopleList/Items/EditingItem.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  KeyCodes,\n  getId,\n  getNativeProps,\n  inputProperties,\n  classNamesFunction,\n  initializeComponentRef,\n} from '../../../../Utilities';\nimport { FloatingPeoplePicker } from '../../../../FloatingPicker';\nimport { getStyles } from './EditingItem.styles';\nimport type { IExtendedPersonaProps } from '../SelectedPeopleList';\nimport type { IPeoplePickerItemState } from './ExtendedSelectedItem';\nimport type {\n  IEditingSelectedPeopleItemProps,\n  IEditingSelectedPeopleItemStyles,\n  IEditingSelectedPeopleItemStylesProps,\n} from './EditingItem.types';\n\nexport class EditingItem extends React.Component<IEditingSelectedPeopleItemProps, IPeoplePickerItemState> {\n  private _editingInput: HTMLInputElement;\n  private _editingFloatingPicker = React.createRef<FloatingPeoplePicker>();\n\n  constructor(props: IEditingSelectedPeopleItemProps) {\n    super(props);\n\n    initializeComponentRef(this);\n    // eslint-disable-next-line react/no-unused-state\n    this.state = { contextualMenuVisible: false };\n  }\n\n  public componentDidMount(): void {\n    const getEditingItemText = this.props.getEditingItemText as (item: IExtendedPersonaProps) => string;\n    const itemText = getEditingItemText(this.props.item);\n\n    this._editingFloatingPicker.current && this._editingFloatingPicker.current.onQueryStringChanged(itemText);\n    this._editingInput.value = itemText;\n    this._editingInput.focus();\n  }\n\n  public render(): JSX.Element {\n    const itemId = getId();\n    const nativeProps = getNativeProps<React.InputHTMLAttributes<HTMLInputElement>>(this.props, inputProperties);\n    const getClassNames = classNamesFunction<IEditingSelectedPeopleItemStylesProps, IEditingSelectedPeopleItemStyles>();\n    const classNames = getClassNames(getStyles);\n    return (\n      <div aria-labelledby={'editingItemPersona-' + itemId} className={classNames.root}>\n        <input\n          autoCapitalize={'off'}\n          autoComplete={'off'}\n          {...nativeProps}\n          ref={this._resolveInputRef}\n          onChange={this._onInputChange}\n          onKeyDown={this._onInputKeyDown}\n          onBlur={this._onInputBlur}\n          onClick={this._onInputClick}\n          data-lpignore={true}\n          className={classNames.input}\n          id={itemId}\n        />\n        {this._renderEditingSuggestions()}\n      </div>\n    );\n  }\n\n  private _renderEditingSuggestions = (): JSX.Element => {\n    const FloatingPicker = this.props.onRenderFloatingPicker;\n    const floatingPickerProps = this.props.floatingPickerProps;\n    if (!FloatingPicker || !floatingPickerProps) {\n      return <></>;\n    }\n    return (\n      <FloatingPicker\n        componentRef={this._editingFloatingPicker}\n        onChange={this._onSuggestionSelected}\n        inputElement={this._editingInput}\n        selectedItems={[]}\n        {...floatingPickerProps}\n      />\n    );\n  };\n\n  private _resolveInputRef = (ref: HTMLInputElement): void => {\n    this._editingInput = ref;\n\n    this.forceUpdate(() => {\n      this._editingInput.focus();\n    });\n  };\n\n  private _onInputClick = (): void => {\n    this._editingFloatingPicker.current && this._editingFloatingPicker.current.showPicker(true /*updatevalue*/);\n  };\n\n  private _onInputBlur = (ev: React.FocusEvent<HTMLElement>): void => {\n    if (this._editingFloatingPicker.current && ev.relatedTarget !== null) {\n      const target = ev.relatedTarget as HTMLElement;\n      if (\n        target.className.indexOf('ms-Suggestions-itemButton') === -1 &&\n        target.className.indexOf('ms-Suggestions-sectionButton') === -1\n      ) {\n        this._editingFloatingPicker.current.forceResolveSuggestion();\n      }\n    }\n  };\n\n  private _onInputChange = (ev: React.FormEvent<HTMLElement>): void => {\n    const value: string = (ev.target as HTMLInputElement).value;\n\n    if (value === '') {\n      if (this.props.onRemoveItem) {\n        this.props.onRemoveItem();\n      }\n    } else {\n      this._editingFloatingPicker.current && this._editingFloatingPicker.current.onQueryStringChanged(value);\n    }\n  };\n\n  private _onInputKeyDown(ev: React.KeyboardEvent<HTMLInputElement>): void {\n    // eslint-disable-next-line deprecation/deprecation\n    if (ev.which === KeyCodes.backspace || ev.which === KeyCodes.del) {\n      ev.stopPropagation();\n    }\n  }\n\n  private _onSuggestionSelected = (item: IExtendedPersonaProps): void => {\n    this.props.onEditingComplete(this.props.item, item);\n  };\n}\n"]}