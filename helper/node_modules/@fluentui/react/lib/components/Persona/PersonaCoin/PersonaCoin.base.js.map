{"version":3,"file":"PersonaCoin.base.js","sourceRoot":"../src/","sources":["components/Persona/PersonaCoin/PersonaCoin.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  classNamesFunction,\n  divProperties,\n  memoizeFunction,\n  getInitials,\n  getNativeProps,\n  getRTL,\n  getPropsWithDefaults,\n} from '../../../Utilities';\nimport { mergeStyles } from '../../../Styling';\nimport { PersonaPresence } from '../PersonaPresence/index';\nimport { Icon } from '../../../Icon';\nimport { Image, ImageFit, ImageLoadState } from '../../../Image';\nimport { PersonaInitialsColor, PersonaPresence as PersonaPresenceEnum, PersonaSize } from '../Persona.types';\nimport { getPersonaInitialsColor } from '../PersonaInitialsColor';\nimport { sizeToPixels } from '../PersonaConsts';\nimport { useWarnings } from '@fluentui/react-hooks';\nimport type {\n  IPersonaCoinProps,\n  IPersonaCoinStyleProps,\n  IPersonaCoinStyles,\n  IPersonaPresenceProps,\n} from '../Persona.types';\n\nconst getClassNames = classNamesFunction<IPersonaCoinStyleProps, IPersonaCoinStyles>({\n  // There can be many PersonaCoin rendered with different sizes.\n  // Therefore setting a larger cache size.\n  cacheSize: 100,\n});\n\nconst getInitialsStyles = memoizeFunction(\n  (\n    className: string,\n    initialsColor: PersonaInitialsColor | string | undefined,\n    initialsTextColor: string | undefined,\n    text: string | undefined,\n    primaryText: string | undefined,\n    showUnknownPersonaCoin: boolean | undefined,\n  ) =>\n    mergeStyles(\n      className,\n      !showUnknownPersonaCoin && {\n        backgroundColor: getPersonaInitialsColor({ text, initialsColor, primaryText }),\n        color: initialsTextColor,\n      },\n    ),\n);\n\nconst DEFAULT_PROPS = {\n  size: PersonaSize.size48,\n  presence: PersonaPresenceEnum.none,\n  imageAlt: '',\n};\n\nfunction useDebugWarnings(props: IPersonaCoinProps) {\n  if (process.env.NODE_ENV !== 'production') {\n    // eslint-disable-next-line react-hooks/rules-of-hooks -- build-time conditional\n    useWarnings({\n      name: 'PersonaCoin',\n      props,\n      deprecations: { primaryText: 'text' },\n    });\n  }\n}\n\nfunction useImageLoadState({ onPhotoLoadingStateChange, imageUrl }: IPersonaCoinProps) {\n  const [imageLoadState, setImageLoadstate] = React.useState<ImageLoadState>(ImageLoadState.notLoaded);\n\n  React.useEffect(() => {\n    setImageLoadstate(ImageLoadState.notLoaded);\n  }, [imageUrl]);\n\n  const onLoadingStateChange = (loadState: ImageLoadState) => {\n    setImageLoadstate(loadState);\n\n    onPhotoLoadingStateChange?.(loadState);\n  };\n\n  return [imageLoadState, onLoadingStateChange] as const;\n}\n\n/**\n * PersonaCoin with no default styles.\n * [Use the `getStyles` API to add your own styles.](https://github.com/microsoft/fluentui/wiki/Styling)\n */\nexport const PersonaCoinBase: React.FunctionComponent<IPersonaCoinProps> = React.forwardRef<\n  HTMLDivElement,\n  IPersonaCoinProps\n>((propsWithoutDefaults, forwardedRef) => {\n  const props = getPropsWithDefaults(DEFAULT_PROPS, propsWithoutDefaults);\n\n  useDebugWarnings(props);\n\n  const [imageLoadState, onLoadingStateChange] = useImageLoadState(props);\n\n  const renderCoin = getCoinRenderer(onLoadingStateChange);\n\n  const {\n    className,\n    coinProps,\n    showUnknownPersonaCoin,\n    coinSize,\n    styles,\n    imageUrl,\n    initialsColor,\n    initialsTextColor,\n    isOutOfOffice,\n    // eslint-disable-next-line deprecation/deprecation\n    onRenderCoin = renderCoin,\n    // eslint-disable-next-line deprecation/deprecation\n    onRenderPersonaCoin = onRenderCoin,\n    onRenderInitials = renderPersonaCoinInitials,\n    presence,\n    presenceTitle,\n    presenceColors,\n    // eslint-disable-next-line deprecation/deprecation\n    primaryText,\n    showInitialsUntilImageLoads,\n    text,\n    theme,\n    size,\n  } = props;\n\n  const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(props, divProperties);\n  const divCoinProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(coinProps || {}, divProperties);\n  const coinSizeStyle = coinSize ? { width: coinSize, height: coinSize } : undefined;\n  const hideImage = showUnknownPersonaCoin;\n\n  const personaPresenceProps: IPersonaPresenceProps = {\n    coinSize,\n    isOutOfOffice,\n    presence,\n    presenceTitle,\n    presenceColors,\n    size,\n    theme,\n  };\n\n  // Use getStyles from props, or fall back to getStyles from styles file.\n  const classNames = getClassNames(styles, {\n    theme: theme!,\n    className: coinProps && coinProps.className ? coinProps.className : className,\n    size,\n    coinSize,\n    showUnknownPersonaCoin,\n  });\n\n  const shouldRenderInitials = Boolean(\n    imageLoadState !== ImageLoadState.loaded &&\n      ((showInitialsUntilImageLoads && imageUrl) || !imageUrl || imageLoadState === ImageLoadState.error || hideImage),\n  );\n\n  return (\n    <div role=\"presentation\" {...divProps} className={classNames.coin} ref={forwardedRef}>\n      {\n        // Render PersonaCoin if size is not size8. size10 and tiny need to removed after a deprecation cleanup.\n        // eslint-disable-next-line deprecation/deprecation\n        size !== PersonaSize.size8 && size !== PersonaSize.size10 && size !== PersonaSize.tiny ? (\n          <div role=\"presentation\" {...divCoinProps} className={classNames.imageArea} style={coinSizeStyle}>\n            {shouldRenderInitials && (\n              <div\n                className={getInitialsStyles(\n                  classNames.initials,\n                  initialsColor,\n                  initialsTextColor,\n                  text,\n                  primaryText,\n                  showUnknownPersonaCoin,\n                )}\n                style={coinSizeStyle}\n                aria-hidden=\"true\"\n              >\n                {onRenderInitials(props, renderPersonaCoinInitials)}\n              </div>\n            )}\n            {!hideImage && onRenderPersonaCoin(props, renderCoin)}\n            <PersonaPresence {...personaPresenceProps} />\n          </div>\n        ) : // Otherwise, render just PersonaPresence.\n        props.presence ? (\n          <PersonaPresence {...personaPresenceProps} />\n        ) : (\n          // Just render Contact Icon if there isn't a Presence prop.\n          <Icon iconName=\"Contact\" className={classNames.size10WithoutPresenceIcon} />\n        )\n      }\n      {props.children}\n    </div>\n  );\n});\nPersonaCoinBase.displayName = 'PersonaCoinBase';\n\nconst getCoinRenderer = (onLoadingStateChange: (loadState: ImageLoadState) => void) => ({\n  coinSize,\n  styles,\n  imageUrl,\n  imageAlt,\n  imageShouldFadeIn,\n  imageShouldStartVisible,\n  theme,\n  showUnknownPersonaCoin,\n  size = DEFAULT_PROPS.size,\n}: IPersonaCoinProps): JSX.Element | null => {\n  // Render the Image component only if an image URL is provided\n  if (!imageUrl) {\n    return null;\n  }\n  const classNames = getClassNames(styles, {\n    theme: theme!,\n    size,\n    showUnknownPersonaCoin,\n  });\n  const dimension = coinSize || sizeToPixels[size];\n  return (\n    <Image\n      className={classNames.image}\n      imageFit={ImageFit.cover}\n      src={imageUrl}\n      width={dimension}\n      height={dimension}\n      alt={imageAlt}\n      shouldFadeIn={imageShouldFadeIn}\n      shouldStartVisible={imageShouldStartVisible}\n      onLoadingStateChange={onLoadingStateChange}\n    />\n  );\n};\n\nconst renderPersonaCoinInitials = ({\n  imageInitials,\n  allowPhoneInitials,\n  showUnknownPersonaCoin,\n  text,\n  // eslint-disable-next-line deprecation/deprecation\n  primaryText,\n  theme,\n}: IPersonaCoinProps): JSX.Element => {\n  if (showUnknownPersonaCoin) {\n    return <Icon iconName=\"Help\" />;\n  }\n\n  const isRTL = getRTL(theme);\n\n  imageInitials = imageInitials || getInitials(text || primaryText || '', isRTL, allowPhoneInitials);\n\n  return imageInitials !== '' ? <span>{imageInitials}</span> : <Icon iconName=\"Contact\" />;\n};\n"]}