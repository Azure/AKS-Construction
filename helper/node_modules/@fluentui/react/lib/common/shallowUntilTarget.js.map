{"version":3,"file":"shallowUntilTarget.js","sourceRoot":"../src/","sources":["common/shallowUntilTarget.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,OAAO,EAAkB,MAAM,QAAQ,CAAC;AAsBjD;;;;;;;GAOG;AACH,MAAM,UAAU,kBAAkB,CAChC,iBAAwC,EACxC,eAAuB,EACvB,OAGC;IAHD,wBAAA,EAAA;QACE,QAAQ,EAAE,EAAE;QACZ,cAAc,EAAE,EAAE;KACnB;IAEO,IAAA,QAAQ,GAAqB,OAAO,SAA5B,EAAE,cAAc,GAAK,OAAO,eAAZ,CAAa;IAE7C,IAAI,IAAI,GAAG,OAAO,CAAO,iBAAiB,EAAE,cAAc,CAAC,CAAC;IAC5D,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;IAE3B,IAAI,OAAO,QAAQ,KAAK,QAAQ,IAAI,QAAQ,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,EAAE;QACvF,oBAAoB;QACpB,8CAA8C;QAC9C,qDAAqD;QACrD,OAAO,IAAI,CAAC;KACb;IAED,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,IAAI,QAAQ,EAAE,KAAK,EAAE,EAAE;QAC9C,kDAAkD;QAClD,mCAAmC;QACnC,IAAI,QAAQ,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,EAAE;YACvD,qDAAqD;YACrD,OAAO,IAAI,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;SAC7C;QACD,8CAA8C;QAC9C,IAAI,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;QAC5C,QAAQ,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;KACxB;IAED,MAAM,IAAI,KAAK,CACb,oBAAkB,eAAe,4BAAuB,iBAAiB,6BACzD,QAAQ,WAAQ,CACjC,CAAC;AACJ,CAAC","sourcesContent":["import * as React from 'react';\nimport { shallow, ShallowWrapper } from 'enzyme';\n\n/**\n * Duplicated enzyme's ShallowRendererProps\n *\n * @internal\n */\nexport interface IShallowRendererProps {\n  lifecycleExperimental?: boolean;\n  disableLifecycleMethods?: boolean;\n}\n\n/**\n * ShallowUntilTarget Interface\n *\n * @internal\n */\nexport interface IShallowUntilTarget {\n  maxTries: number;\n  shallowOptions: IShallowRendererProps;\n}\n\n/**\n * An extention of enzyme's shallow function which will fail to work\n * with decorated components and/or components using the styled() function.\n * This function allows you to pass a 'target' component (e.g. ComponentBase)\n * and keep running shallow on each child component till a match is found.\n *\n * @public\n */\nexport function shallowUntilTarget<P, S>(\n  componentInstance: React.ReactElement<P>,\n  TargetComponent: string,\n  options: IShallowUntilTarget = {\n    maxTries: 10,\n    shallowOptions: {},\n  },\n): ShallowWrapper {\n  const { maxTries, shallowOptions } = options;\n\n  let root = shallow<P, S>(componentInstance, shallowOptions);\n  let rootType = root.type();\n\n  if (typeof rootType === 'string' || rootType.toString().indexOf(TargetComponent) !== -1) {\n    // Default shallow()\n    // If type() is a string then it's a DOM Node.\n    // If it were wrapped, it would be a React component.\n    return root;\n  }\n\n  for (let tries = 1; tries <= maxTries; tries++) {\n    // Check for target as a string to avoid conflicts\n    // with decoratored components name\n    if (rootType.toString().indexOf(TargetComponent) !== -1) {\n      // Now that we found the target component, render it.\n      return root.first().shallow(shallowOptions);\n    }\n    // Unwrap the next component in the hierarchy.\n    root = root.first().shallow(shallowOptions);\n    rootType = root.type();\n  }\n\n  throw new Error(\n    `Could not find ${TargetComponent} in React instance: ${componentInstance};\n    gave up after ${maxTries} tries`,\n  );\n}\n"]}